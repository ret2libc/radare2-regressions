NAME=ib
FILE=../bins/elf/analysis/main
EXPECT=<<EOF
xor ebp, ebp
0x00000410
EOF
CMDS=<<EOF
e bin.baddr=0
e asm.calls=false
ib
op 3
e io.va=0
s entry0
pi 1
?p
EOF
RUN

NAME=ibib
FILE=../bins/elf/analysis/main
EXPECT=<<EOF
works
EOF
CMDS=<<EOF
?e works
ib;ib
EOF
RUN

NAME=ibib2
FILE=../bins/elf/analysis/main
EXPECT=<<EOF
works
EOF
CMDS=<<EOF
ib;ib
?e works
EOF
RUN

NAME=ih (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Header fields]
0x00000000 0x00000000 ELF; 0x464c457f
0x00000010 0x00000010 Type; 0x00000002
0x00000012 0x00000012 Machine; 0x00000003
0x00000014 0x00000014 Version; 0x00000001
0x00000018 0x00000018 Entry point; 0x08048300
0x0000001c 0x0000001c PhOff; 0x00000034
0x00000020 0x00000020 ShOff; 0x000007cc

7 fields
EOF
CMDS=<<EOF
ihq
EOF
RUN

NAME=i (all) (malloc)
FILE=malloc://1025
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
file     malloc://1025
format   any
iorw     true
mode     rwx
size     0x401
humansz  1.0K
baddr    0x0
binsz    1025
bits     64
canary   false
sanitiz  false
crypto   false
endian   little
havecode false
laddr    0x0
linenum  false
lsyms    false
maxopsz  16
minopsz  1
nx       false
pcalign  0
pic      false
relocs   false
static   true
stripped false
va       false
[Imports]
Num  Vaddr       Bind      Type Name
[Exports]
Num Paddr      Vaddr      Bind     Type Size Name
e cfg.bigendian=false
e asm.bits=64
e asm.dwarf=false
e asm.pcalign=0
fs imports
fs symbols
fs exports
[Imports]
Num  Vaddr       Bind      Type Name
fs imports
[Entrypoints]

0 entrypoints
fs symbols
[Symbols]
Num Paddr      Vaddr      Bind     Type Size Name
fs symbols
[Sections]
Nm Paddr       Size Vaddr      Memsz Perms Name
fs sections
EOF
ARGS=-a x86
CMDS=<<EOF
i
ia
ia*
ii
ii*
ie
ie*
is
is*
iS
iS*
iz
iz*
EOF
RUN

NAME=i (all) (malloc) iI*
FILE=malloc://1024
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
file     malloc://1024
format   any
iorw     true
mode     rwx
size     0x400
humansz  1K
e cfg.bigendian=false
e asm.bits=64
e asm.dwarf=false
e asm.pcalign=0
baddr    0x0
binsz    1024
bits     64
canary   false
sanitiz  false
crypto   false
endian   little
havecode false
laddr    0x0
linenum  false
lsyms    false
maxopsz  16
minopsz  1
nx       false
pcalign  0
pic      false
relocs   false
static   true
stripped false
va       false
e cfg.bigendian=false
e asm.bits=64
e asm.dwarf=false
e asm.pcalign=0
EOF
ARGS=-a x86
CMDS=<<EOF
i
i*
iI
iI*
EOF
RUN

NAME=i (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
format   elf
iorw     false
mode     r-x
size     0x1323
humansz  4.8K
arch     x86
baddr    0x8048000
binsz    4899
bintype  elf
bits     32
canary   false
sanitiz  false
class    ELF32
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  Intel 80386
maxopsz  16
minopsz  1
nx       true
os       linux
pcalign  0
pic      false
relocs   true
relro    no
rpath    NONE
static   false
stripped false
subsys   linux
va       true
EOF
CMDS=<<EOF
i~!file
EOF
RUN

NAME=iA (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
000 0x00000000 4899 x86_32
EOF
CMDS=<<EOF
iA
EOF
RUN

NAME=ib java class file
FILE=malloc://1024
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
file     malloc://1024
format   java
iorw     true
mode     rwx
size     0x400
humansz  1K
type     JAVA CLASS
arch     java
baddr    0x0
binsz    1024
bintype  class
bits     32
canary   false
retguard false
sanitiz  false
class    0x3200 0x0000
crypto   false
endian   little
havecode true
laddr    0x0
lang     java 6
linenum  true
lsyms    true
machine  jvm
nx       false
os       any
pic      false
relocs   false
static   false
stripped false
subsys   any
va       false
  ;-- entry1:
  ;-- method.TestVariableSwitchUp.TestMultipleVariable:
/ (fcn) sym.TestVariableSwitchUp.TestMultipleVariable 37
| 0x000002fd      1064           bipush 100
| 0x000002ff      b8000f         invokestatic java/lang/Integer/valueOf(I)Ljava/lang/Integer;
| 0x00000302      4b             astore_0
| 0x00000303      1064           bipush 100
| 0x00000305      3c             istore_1
| 0x00000306      1215           ldc "tryone"
| 0x00000308      4d             astore_2
| 0x00000309      03             iconst_0
| 0x0000030a      3e             istore_3
| 0x0000030b      b20017         getstatic java/lang/System/out Ljava/io/PrintStream;
| 0x0000030e      bb001d         new java/lang/StringBuilder
| 0x00000311      59             dup
| 0x00000312      121f           ldc "Attempting print "
| 0x00000314      b70021         invokespecial java/lang/StringBuilder/<init>(Ljava/lang/String;)V
| 0x00000317      2c             aload_2
| 0x00000318      b60024         invokevirtual java/lang/StringBuilder/append(Ljava/lang/String;)Ljava/lang/StringBuilder;
| 0x0000031b      b60028         invokevirtual java/lang/StringBuilder/toString()Ljava/lang/String;
| 0x0000031e      b6002c         invokevirtual java/io/PrintStream/print(Ljava/lang/String;)V
\ 0x00000321      b1             return
EOF
CMDS=<<EOF
e asm.calls=false
e asm.comments=false
e asm.cmtflgrefs=false
e scr.color=false
e asm.lines.bb=false
e asm.xrefs=false
wx cafebabe00000032003a070002010014546573745661726961626c6553776974636855700700040100106a6176612f6c616e672f4f626a6563740100063c696e69743e010003282956010004436f64650a000300090c0005000601000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100164c546573745661726961626c6553776974636855703b010014546573744d756c7469706c655661726961626c650a001000120700110100116a6176612f6c616e672f496e74656765720c0013001401000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b0800160100067472796f6e65090018001a0700190100106a6176612f6c616e672f53797374656d0c001b001c0100036f75740100154c6a6176612f696f2f5072696e7453747265616d3b07001e0100176a6176612f6c616e672f537472696e674275696c646572080020010011417474656d7074696e67207072696e74200a001d00220c00050023010015284c6a6176612f6c616e672f537472696e673b29560a001d00250c00260027010006617070656e6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f537472696e674275696c6465723b0a001d00290c002a002b010008746f537472696e6701001428294c6a6176612f6c616e672f537472696e673b0a002d002f07002e0100136a6176612f696f2f5072696e7453747265616d0c003000230100057072696e74010001690100134c6a6176612f6c616e672f496e74656765723b01000170010001490100016b0100124c6a6176612f6c616e672f537472696e673b0100016a01000a536f7572636546696c65010019546573745661726961626c6553776974636855702e6a617661002100010003000000000002000100050006000100070000002f00010001000000052ab70008b100000002000a00000006000100000002000b0000000c000100000005000c000d00000008000e0006000100070000008100040004000000251064b8000f4b10643c12154d033eb20017bb001d59121fb700212cb60024b60028b6002cb100000002000a0000001a0006000000040006000500090006000c0007000e000800240009000b0000002a00040006001f0031003200000009001c003300340001000c0019003500360002000e001700370034000300010038000000020039
ib
if
af
pdf
EOF

RUN

NAME=ic cpp classes
FILE=../bins/elf/libmagic.so
EXPECT=<<EOF
0x00000000 [0x00006060 - 0x0000697c] (sz 2332) class 0 _JNIEnv
0x000074f8 method 0      inject(_JNIEnv*,_jobject*,_jstring*,_jstring*)
0x0000699c method 1      findBaseDexClassloader(_JNIEnv*,_jobject*)
0x00006a2c method 2      getField(_JNIEnv*,_jobject*,_jobject*,_jstring*)
0x00006abc method 3      getPathList(_JNIEnv*,_jobject*)
0x00006af4 method 4      getDexElements(_JNIEnv*,_jobject*)
0x00006b1c method 5      setField(_JNIEnv*,_jobject*,_jobject*,_jstring*,_jobject*)
0x00006bb0 method 6      combineArray(_JNIEnv*,_jobject*,_jobject*)
0x00006d00 method 7      injectAboveEqualApiLevel14(_JNIEnv*,_jobject*,_jstring*,_jstring*)
0x00006e5c method 8      appendArray(_JNIEnv*,_jobject*,_jobject*)
0x00006f68 method 9      injectInAliyunOs(_JNIEnv*,_jobject*,_jstring*,_jstring*)
0x0000720c method 10      injectBelowApiLevel14(_JNIEnv*,_jobject*,_jstring*,_jstring*)
0x00006060 method 0      FindClass(charconst*)
EOF
CMDS=<<EOF
ic~_JNIEnv
ic~FindClass
EOF
RUN

NAME=ie (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Entrypoints]
vaddr=0x08048300 paddr=0x00000300 haddr=0x00000018 hvaddr=0x08048018 type=program

1 entrypoints
EOF
CMDS=<<EOF
ie
EOF
RUN

NAME=iej (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT='[{"vaddr":134513408,"paddr":768,"baddr":134512640,"laddr":0,"hvaddr":134512664,"haddr":24,"type":"program"}]
'
CMDS=<<EOF
iej
EOF
RUN

NAME=ii (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Imports]
Num  Vaddr       Bind      Type Name
   1 0x080482d0  GLOBAL    FUNC puts
   2 0x080482e0    WEAK  NOTYPE __gmon_start__
   3 0x080482f0  GLOBAL    FUNC __libc_start_main
EOF
CMDS=<<EOF
ii
EOF
RUN

NAME=iI (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
arch     x86
baddr    0x8048000
binsz    4899
bintype  elf
bits     32
canary   false
sanitiz  false
class    ELF32
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  Intel 80386
maxopsz  16
minopsz  1
nx       true
os       linux
pcalign  0
pic      false
relocs   true
relro    no
rpath    NONE
static   false
stripped false
subsys   linux
va       true
EOF
CMDS=<<EOF
iI
EOF
RUN

NAME=iIj
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=iIj~{}
EXPECT='{
  "arch": "x86",
  "baddr": 134512640,
  "binsz": 4899,
  "bintype": "elf",
  "bits": 32,
  "canary": false,
  "sanitiz": false,
  "class": "ELF32",
  "compiled": "",
  "crypto": false,
  "dbg_file": "",
  "endian": "little",
  "havecode": true,
  "guid": "",
  "intrp": "/lib/ld-linux.so.2",
  "laddr": 0,
  "lang": "c",
  "linenum": true,
  "lsyms": true,
  "machine": "Intel 80386",
  "maxopsz": 16,
  "minopsz": 1,
  "nx": true,
  "os": "linux",
  "pcalign": 0,
  "pic": false,
  "relocs": true,
  "relro": "no",
  "rpath": "NONE",
  "static": false,
  "stripped": false,
  "subsys": "linux",
  "va": true,
  "checksums": {
    
  }
}'
RUN

NAME=iI-rust
FILE=../bins/elf/analysis/rust_full
CMDS=iI~lang
EXPECT='lang     rust
'
RUN

NAME=iI-msvc
FILE=../bins/pe/libzmq-v100-mt-4_0_4.dll
CMDS=iI~lang
EXPECT='lang     msvc
'
RUN

NAME=im
FILE=../bins/nes/Pong.nes
EXPECT=<<EOF
1
EOF
CMDS=<<EOF
im~?SRAM
EOF
RUN

NAME=imj
FILE=../bins/nes/Pong.nes
EXPECT=<<EOF
1
EOF
CMDS=<<EOF
imj~?SRAM
EOF
RUN

NAME=iS (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Sections]
Nm Paddr       Size Vaddr      Memsz Perms Name
00 0x00000000     0 0x00000000     0 ---- 
01 0x00000134    19 0x08048134    19 -r-- .interp
02 0x00000148    32 0x08048148    32 -r-- .note.ABI_tag
03 0x00000168    36 0x08048168    36 -r-- .note.gnu.build_id
04 0x0000018c    32 0x0804818c    32 -r-- .gnu.hash
05 0x000001ac    80 0x080481ac    80 -r-- .dynsym
06 0x000001fc    74 0x080481fc    74 -r-- .dynstr
07 0x00000246    10 0x08048246    10 -r-- .gnu.version
08 0x00000250    32 0x08048250    32 -r-- .gnu.version_r
09 0x00000270     8 0x08048270     8 -r-- .rel.dyn
10 0x00000278    24 0x08048278    24 -r-- .rel.plt
11 0x00000290    35 0x08048290    35 -r-x .init
12 0x000002c0    64 0x080482c0    64 -r-x .plt
13 0x00000300   404 0x08048300   404 -r-x .text
14 0x00000494    20 0x08048494    20 -r-x .fini
15 0x000004a8    21 0x080484a8    21 -r-- .rodata
16 0x000004c0    44 0x080484c0    44 -r-- .eh_frame_hdr
17 0x000004ec   176 0x080484ec   176 -r-- .eh_frame
18 0x0000059c     4 0x0804959c     4 -rw- .init_array
19 0x000005a0     4 0x080495a0     4 -rw- .fini_array
20 0x000005a4     4 0x080495a4     4 -rw- .jcr
21 0x000005a8   232 0x080495a8   232 -rw- .dynamic
22 0x00000690     4 0x08049690     4 -rw- .got
23 0x00000694    24 0x08049694    24 -rw- .got.plt
24 0x000006ac     8 0x080496ac     8 -rw- .data
25 0x000006b4     0 0x080496b4     4 -rw- .bss
26 0x000006b4    17 0x00000000    17 ---- .comment
27 0x000006c5   262 0x00000000   262 ---- .shstrtab
28 0x00000c7c  1104 0x00000000  1104 ---- .symtab
29 0x000010cc   599 0x00000000   599 ---- .strtab
EOF
CMDS=<<EOF
iS
EOF
RUN

NAME=iSS (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EXPECT
iSS
EXPECT=<<RUN
[Segments]
Nm Paddr       Size Vaddr      Memsz Perms Name
00 0x00000034   256 0x08048034   256 -r-x PHDR
01 0x00000134    19 0x08048134    19 -r-- INTERP
02 0x00000000  1436 0x08048000  1436 -r-x LOAD0
03 0x0000059c   280 0x0804959c   284 -rw- LOAD1
04 0x000005a8   232 0x080495a8   232 -rw- DYNAMIC
05 0x00000148    68 0x08048148    68 -r-- NOTE
06 0x000004c0    44 0x080484c0    44 -r-- GNU_EH_FRAME
07 0x00000000     0 0x00000000     0 -rw- GNU_STACK
08 0x00000000    52 0x08048000    52 -rw- ehdr
RUN

NAME=iSj
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EXPECT
iSj
EXPECT=<<RUN
[{"name":"","size":0,"vsize":0,"perm":"----","paddr":0,"vaddr":0},{"name":".interp","size":19,"vsize":19,"perm":"-r--","paddr":308,"vaddr":134512948},{"name":".note.ABI_tag","size":32,"vsize":32,"perm":"-r--","paddr":328,"vaddr":134512968},{"name":".note.gnu.build_id","size":36,"vsize":36,"perm":"-r--","paddr":360,"vaddr":134513000},{"name":".gnu.hash","size":32,"vsize":32,"perm":"-r--","paddr":396,"vaddr":134513036},{"name":".dynsym","size":80,"vsize":80,"perm":"-r--","paddr":428,"vaddr":134513068},{"name":".dynstr","size":74,"vsize":74,"perm":"-r--","paddr":508,"vaddr":134513148},{"name":".gnu.version","size":10,"vsize":10,"perm":"-r--","paddr":582,"vaddr":134513222},{"name":".gnu.version_r","size":32,"vsize":32,"perm":"-r--","paddr":592,"vaddr":134513232},{"name":".rel.dyn","size":8,"vsize":8,"perm":"-r--","paddr":624,"vaddr":134513264},{"name":".rel.plt","size":24,"vsize":24,"perm":"-r--","paddr":632,"vaddr":134513272},{"name":".init","size":35,"vsize":35,"perm":"-r-x","paddr":656,"vaddr":134513296},{"name":".plt","size":64,"vsize":64,"perm":"-r-x","paddr":704,"vaddr":134513344},{"name":".text","size":404,"vsize":404,"perm":"-r-x","paddr":768,"vaddr":134513408},{"name":".fini","size":20,"vsize":20,"perm":"-r-x","paddr":1172,"vaddr":134513812},{"name":".rodata","size":21,"vsize":21,"perm":"-r--","paddr":1192,"vaddr":134513832},{"name":".eh_frame_hdr","size":44,"vsize":44,"perm":"-r--","paddr":1216,"vaddr":134513856},{"name":".eh_frame","size":176,"vsize":176,"perm":"-r--","paddr":1260,"vaddr":134513900},{"name":".init_array","size":4,"vsize":4,"perm":"-rw-","paddr":1436,"vaddr":134518172},{"name":".fini_array","size":4,"vsize":4,"perm":"-rw-","paddr":1440,"vaddr":134518176},{"name":".jcr","size":4,"vsize":4,"perm":"-rw-","paddr":1444,"vaddr":134518180},{"name":".dynamic","size":232,"vsize":232,"perm":"-rw-","paddr":1448,"vaddr":134518184},{"name":".got","size":4,"vsize":4,"perm":"-rw-","paddr":1680,"vaddr":134518416},{"name":".got.plt","size":24,"vsize":24,"perm":"-rw-","paddr":1684,"vaddr":134518420},{"name":".data","size":8,"vsize":8,"perm":"-rw-","paddr":1708,"vaddr":134518444},{"name":".bss","size":0,"vsize":4,"perm":"-rw-","paddr":1716,"vaddr":134518452},{"name":".comment","size":17,"vsize":17,"perm":"----","paddr":1716,"vaddr":0},{"name":".shstrtab","size":262,"vsize":262,"perm":"----","paddr":1733,"vaddr":0},{"name":".symtab","size":1104,"vsize":1104,"perm":"----","paddr":3196,"vaddr":0},{"name":".strtab","size":599,"vsize":599,"perm":"----","paddr":4300,"vaddr":0}]
RUN

NAME=iSSj
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EXPECT
iSSj
EXPECT=<<RUN
[{"name":"PHDR","size":256,"vsize":256,"perm":"-r-x","paddr":52,"vaddr":134512692},{"name":"INTERP","size":19,"vsize":19,"perm":"-r--","paddr":308,"vaddr":134512948},{"name":"LOAD0","size":1436,"vsize":1436,"perm":"-r-x","paddr":0,"vaddr":134512640},{"name":"LOAD1","size":280,"vsize":284,"perm":"-rw-","paddr":1436,"vaddr":134518172},{"name":"DYNAMIC","size":232,"vsize":232,"perm":"-rw-","paddr":1448,"vaddr":134518184},{"name":"NOTE","size":68,"vsize":68,"perm":"-r--","paddr":328,"vaddr":134512968},{"name":"GNU_EH_FRAME","size":44,"vsize":44,"perm":"-r--","paddr":1216,"vaddr":134513856},{"name":"GNU_STACK","size":0,"vsize":0,"perm":"-rw-","paddr":0,"vaddr":0},{"name":"ehdr","size":52,"vsize":52,"perm":"-rw-","paddr":0,"vaddr":134512640}]
RUN

NAME=iSq
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=iSq
EXPECT=<<RUN
0x0 0x0 ---- 
0x8048134 0x8048147 -r-- .interp
0x8048148 0x8048168 -r-- .note.ABI_tag
0x8048168 0x804818c -r-- .note.gnu.build_id
0x804818c 0x80481ac -r-- .gnu.hash
0x80481ac 0x80481fc -r-- .dynsym
0x80481fc 0x8048246 -r-- .dynstr
0x8048246 0x8048250 -r-- .gnu.version
0x8048250 0x8048270 -r-- .gnu.version_r
0x8048270 0x8048278 -r-- .rel.dyn
0x8048278 0x8048290 -r-- .rel.plt
0x8048290 0x80482b3 -r-x .init
0x80482c0 0x8048300 -r-x .plt
0x8048300 0x8048494 -r-x .text
0x8048494 0x80484a8 -r-x .fini
0x80484a8 0x80484bd -r-- .rodata
0x80484c0 0x80484ec -r-- .eh_frame_hdr
0x80484ec 0x804859c -r-- .eh_frame
0x804959c 0x80495a0 -rw- .init_array
0x80495a0 0x80495a4 -rw- .fini_array
0x80495a4 0x80495a8 -rw- .jcr
0x80495a8 0x8049690 -rw- .dynamic
0x8049690 0x8049694 -rw- .got
0x8049694 0x80496ac -rw- .got.plt
0x80496ac 0x80496b4 -rw- .data
0x80496b4 0x80496b4 -rw- .bss
0x0 0x11 ---- .comment
0x0 0x106 ---- .shstrtab
0x0 0x450 ---- .symtab
0x0 0x257 ---- .strtab
RUN

NAME=iSSq
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=iSSq
EXPECT=<<RUN
0x8048034 0x8048134 -r-x PHDR
0x8048134 0x8048147 -r-- INTERP
0x8048000 0x804859c -r-x LOAD0
0x804959c 0x80496b4 -rw- LOAD1
0x80495a8 0x8049690 -rw- DYNAMIC
0x8048148 0x804818c -r-- NOTE
0x80484c0 0x80484ec -r-- GNU_EH_FRAME
0x0 0x0 -rw- GNU_STACK
0x8048000 0x8048034 -rw- ehdr
RUN

NAME=section comment
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EXPECT
e asm.bytes = false
pd 1 @ 0x080495a8
EXPECT=<<RUN
            ;-- section..dynamic:
            ;-- segment.DYNAMIC:
            ;-- _DYNAMIC:
            0x080495a8      add dword [eax], eax                       ; [21] -rw- section size 232 named .dynamic
RUN

NAME=bss section comment
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EXPECT
pd 3 @ section..bss
EXPECT=<<RUN
            ;-- section..bss:
            ;-- completed.5979:
            ;-- _edata:
            ;-- __bss_start:
            ;-- __TMC_END__:
            0x080496b4      0000           add byte [eax], al          ; [25] -rw- section size 4 named .bss
            0x080496b6      0000           add byte [eax], al
            ;-- _end:
            0x080496b8      ff             invalid
RUN

NAME=il (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Linked libraries]
libc.so.6

1 library
EOF
CMDS=<<EOF
il
EOF
RUN

NAME=ir (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Relocations]
vaddr=0x08049690 paddr=0x00000690 type=SET_32 __gmon_start__
vaddr=0x080496a0 paddr=0x000006a0 type=SET_32 puts
vaddr=0x080496a4 paddr=0x000006a4 type=SET_32 __gmon_start__
vaddr=0x080496a8 paddr=0x000006a8 type=SET_32 __libc_start_main

4 relocations
EOF
CMDS=<<EOF
ir
EOF
RUN

NAME=is (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Symbols]
Num Paddr      Vaddr      Bind     Type Size Name
004 0x000004ac 0x080484ac GLOBAL    OBJ    4 _IO_stdin_used
001 0x00000134 0x08048134  LOCAL   SECT    0
002 0x00000148 0x08048148  LOCAL   SECT    0
003 0x00000168 0x08048168  LOCAL   SECT    0
004 0x0000018c 0x0804818c  LOCAL   SECT    0
005 0x000001ac 0x080481ac  LOCAL   SECT    0
006 0x000001fc 0x080481fc  LOCAL   SECT    0
007 0x00000246 0x08048246  LOCAL   SECT    0
008 0x00000250 0x08048250  LOCAL   SECT    0
009 0x00000270 0x08048270  LOCAL   SECT    0
010 0x00000278 0x08048278  LOCAL   SECT    0
011 0x00000290 0x08048290  LOCAL   SECT    0
012 0x000002c0 0x080482c0  LOCAL   SECT    0
013 0x00000300 0x08048300  LOCAL   SECT    0
014 0x00000494 0x08048494  LOCAL   SECT    0
015 0x000004a8 0x080484a8  LOCAL   SECT    0
016 0x000004c0 0x080484c0  LOCAL   SECT    0
017 0x000004ec 0x080484ec  LOCAL   SECT    0
018 0x0000059c 0x0804959c  LOCAL   SECT    0
019 0x000005a0 0x080495a0  LOCAL   SECT    0
020 0x000005a4 0x080495a4  LOCAL   SECT    0
021 0x000005a8 0x080495a8  LOCAL   SECT    0
022 0x00000690 0x08049690  LOCAL   SECT    0
023 0x00000694 0x08049694  LOCAL   SECT    0
024 0x000006ac 0x080496ac  LOCAL   SECT    0
025 ---------- 0x080496b4  LOCAL   SECT    0
026 ---------- 0x00000000  LOCAL   SECT    0
027 ---------- 0x00000000  LOCAL   FILE    0 init.c
028 ---------- 0x00000000  LOCAL   FILE    0
029 ---------- 0x00000000  LOCAL   FILE    0 crtstuff.c
030 0x000005a4 0x080495a4  LOCAL    OBJ    0 __JCR_LIST__
031 0x00000340 0x08048340  LOCAL   FUNC    0 deregister_tm_clones
032 0x00000370 0x08048370  LOCAL   FUNC    0 register_tm_clones
033 0x000003b0 0x080483b0  LOCAL   FUNC    0 __do_global_dtors_aux
034 ---------- 0x080496b4  LOCAL    OBJ    1 completed.5979
035 0x000005a0 0x080495a0  LOCAL    OBJ    0 __do_global_dtors_aux_fini_array_entry
036 0x000003d0 0x080483d0  LOCAL   FUNC    0 frame_dummy
037 0x0000059c 0x0804959c  LOCAL    OBJ    0 __frame_dummy_init_array_entry
038 ---------- 0x00000000  LOCAL   FILE    0 hello.c
039 ---------- 0x00000000  LOCAL   FILE    0 crtstuff.c
040 0x00000598 0x08048598  LOCAL    OBJ    0 __FRAME_END__
041 0x000005a4 0x080495a4  LOCAL    OBJ    0 __JCR_END__
042 ---------- 0x00000000  LOCAL   FILE    0
043 0x000005a0 0x080495a0  LOCAL NOTYPE    0 __init_array_end
044 0x000005a8 0x080495a8  LOCAL    OBJ    0 _DYNAMIC
045 0x0000059c 0x0804959c  LOCAL NOTYPE    0 __init_array_start
046 0x00000694 0x08049694  LOCAL    OBJ    0 _GLOBAL_OFFSET_TABLE_
047 0x00000490 0x08048490 GLOBAL   FUNC    2 __libc_csu_fini
049 0x00000330 0x08048330 GLOBAL   FUNC    4 __x86.get_pc_thunk.bx
050 0x000006ac 0x080496ac   WEAK NOTYPE    0 data_start
051 ---------- 0x080496b4 GLOBAL NOTYPE    0 _edata
052 0x00000494 0x08048494 GLOBAL   FUNC    0 _fini
053 0x000006ac 0x080496ac GLOBAL NOTYPE    0 __data_start
056 0x000006b0 0x080496b0 GLOBAL    OBJ    0 __dso_handle
059 0x00000420 0x08048420 GLOBAL   FUNC   97 __libc_csu_init
060 ---------- 0x080496b8 GLOBAL NOTYPE    0 _end
061 0x00000300 0x08048300 GLOBAL   FUNC    0 _start
062 0x000004a8 0x080484a8 GLOBAL    OBJ    4 _fp_hw
063 ---------- 0x080496b4 GLOBAL NOTYPE    0 __bss_start
064 0x00000400 0x08048400 GLOBAL   FUNC   28 main
066 ---------- 0x080496b4 GLOBAL    OBJ    0 __TMC_END__
068 0x00000290 0x08048290 GLOBAL   FUNC    0 _init
001 0x000002d0 0x080482d0 GLOBAL   FUNC   16 imp.puts
002 0x000002e0 0x080482e0   WEAK NOTYPE   16 imp.__gmon_start__
003 0x000002f0 0x080482f0 GLOBAL   FUNC   16 imp.__libc_start_main
EOF
CMDS=<<EOF
is
EOF
RUN

NAME=iz (file x86)
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
[Strings]
Num Paddr      Vaddr      Len Size Section  Type  String
000 0x000004b0 0x080484b0  12  13 (.rodata) ascii Hello world!
EOF
CMDS=<<EOF
iz
EOF
RUN

NAME=i (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
format   elf64
iorw     false
mode     r-x
size     0x1a36
humansz  6.6K
type     EXEC (Executable file)
arch     x86
baddr    0x400000
binsz    6710
bintype  elf
bits     64
canary   false
sanitiz  false
class    ELF64
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux-x86-64.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  AMD x86-64 architecture
maxopsz  16
minopsz  1
nx       true
os       linux
pcalign  0
pic      false
relocs   true
relro    no
rpath    NONE
static   false
stripped false
subsys   linux
va       true
EOF
CMDS=<<EOF
i~!hello-linux
EOF
RUN

NAME=iA (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
000 0x00000000 6710 x86_64
EOF
CMDS=<<EOF
iA
EOF
RUN

NAME=ie (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Entrypoints]
vaddr=0x00400410 paddr=0x00000410 haddr=0x00000018 hvaddr=0x00400018 type=program

1 entrypoints
EOF
CMDS=<<EOF
ie
EOF
RUN

NAME=iH (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
0x00000000  ELF64       0x464c457f
0x00000010  Type        0x0002
0x00000012  Machine     0x003e
0x00000014  Version     0x00000001
0x00000018  Entrypoint  0x00400410
0x00000020  PhOff       0x00000040
0x00000028  ShOff       0x00000a30
EOF
CMDS=<<EOF
iH
EOF
RUN

NAME=ii (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Imports]
Num  Vaddr       Bind      Type Name
   1 0x004003e0  GLOBAL    FUNC puts
   2 0x004003f0  GLOBAL    FUNC __libc_start_main
   3 0x00400400    WEAK  NOTYPE __gmon_start__
EOF
CMDS=<<EOF
ii
EOF
RUN

NAME=iI (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
arch     x86
baddr    0x400000
binsz    6710
bintype  elf
bits     64
canary   false
sanitiz  false
class    ELF64
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux-x86-64.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  AMD x86-64 architecture
maxopsz  16
minopsz  1
nx       true
os       linux
pcalign  0
pic      false
relocs   true
relro    no
rpath    NONE
static   false
stripped false
subsys   linux
va       true
EOF
CMDS=<<EOF
iI
EOF
RUN

NAME=iS (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Sections]
Nm Paddr       Size Vaddr      Memsz Perms Name
00 0x00000000     0 0x00000000     0 ---- 
01 0x00000200    26 0x00400200    26 -r-- .interp
02 0x0000021c    32 0x0040021c    32 -r-- .note.ABI_tag
03 0x0000023c    36 0x0040023c    36 -r-- .note.gnu.build_id
04 0x00000260    28 0x00400260    28 -r-- .gnu.hash
05 0x00000280    96 0x00400280    96 -r-- .dynsym
06 0x000002e0    61 0x004002e0    61 -r-- .dynstr
07 0x0000031e     8 0x0040031e     8 -r-- .gnu.version
08 0x00000328    32 0x00400328    32 -r-- .gnu.version_r
09 0x00000348    24 0x00400348    24 -r-- .rela.dyn
10 0x00000360    72 0x00400360    72 -r-- .rela.plt
11 0x000003a8    26 0x004003a8    26 -r-x .init
12 0x000003d0    64 0x004003d0    64 -r-x .plt
13 0x00000410   420 0x00400410   420 -r-x .text
14 0x000005b4     9 0x004005b4     9 -r-x .fini
15 0x000005c0    16 0x004005c0    16 -r-- .rodata
16 0x000005d0    52 0x004005d0    52 -r-- .eh_frame_hdr
17 0x00000608   212 0x00400608   212 -r-- .eh_frame
18 0x000006e0     8 0x006006e0     8 -rw- .init_array
19 0x000006e8     8 0x006006e8     8 -rw- .fini_array
20 0x000006f0     8 0x006006f0     8 -rw- .jcr
21 0x000006f8   464 0x006006f8   464 -rw- .dynamic
22 0x000008c8     8 0x006008c8     8 -rw- .got
23 0x000008d0    48 0x006008d0    48 -rw- .got.plt
24 0x00000900    16 0x00600900    16 -rw- .data
25 0x00000910     0 0x00600910     8 -rw- .bss
26 0x00000910    17 0x00000000    17 ---- .comment
27 0x00000921   264 0x00000000   264 ---- .shstrtab
28 0x000011b0  1608 0x00000000  1608 ---- .symtab
29 0x000017f8   574 0x00000000   574 ---- .strtab
EOF
CMDS=<<EOF
iS
EOF
RUN

NAME=iSS (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
CMDS=<<EXPECT
iSS
EXPECT=<<RUN
[Segments]
Nm Paddr       Size Vaddr      Memsz Perms Name
00 0x00000040   448 0x00400040   448 -r-x PHDR
01 0x00000200    26 0x00400200    26 -r-- INTERP
02 0x00000000  1756 0x00400000  1756 -r-x LOAD0
03 0x000006e0   560 0x006006e0   568 -rw- LOAD1
04 0x000006f8   464 0x006006f8   464 -rw- DYNAMIC
05 0x0000021c    68 0x0040021c    68 -r-- NOTE
06 0x000005d0    52 0x004005d0    52 -r-- GNU_EH_FRAME
07 0x00000000     0 0x00000000     0 -rw- GNU_STACK
08 0x00000000    64 0x00400000    64 -rw- ehdr
RUN

NAME=il (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Linked libraries]
libc.so.6

1 library
EOF
CMDS=<<EOF
il
EOF
RUN

NAME=ir (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Relocations]
vaddr=0x006008c8 paddr=0x000008c8 type=SET_64 __gmon_start__
vaddr=0x006008e8 paddr=0x000008e8 type=SET_64 puts
vaddr=0x006008f0 paddr=0x000008f0 type=SET_64 __libc_start_main
vaddr=0x006008f8 paddr=0x000008f8 type=SET_64 __gmon_start__

4 relocations
EOF
CMDS=<<EOF
ir
EOF
RUN

NAME=ir (file x86_64, ifunc)
FILE=../bins/elf/ifunc_rel64
EXPECT=<<EOF
[Relocations]
vaddr=0x006b17d0 paddr=0x000b17d0 type=SET_64 0x00416530 (ifunc)
vaddr=0x006b17d8 paddr=0x000b17d8 type=SET_64 0x004193a0 (ifunc)
vaddr=0x006b17e0 paddr=0x000b17e0 type=SET_64 0x004199b0 (ifunc)
vaddr=0x006b17e8 paddr=0x000b17e8 type=SET_64 0x00418a50 (ifunc)
vaddr=0x006b17f0 paddr=0x000b17f0 type=SET_64 0x00418de0 (ifunc)
vaddr=0x006b17f8 paddr=0x000b17f8 type=SET_64 0x00419ad0 (ifunc)
vaddr=0x006b1800 paddr=0x000b1800 type=SET_64 0x004193f0 (ifunc)
vaddr=0x006b1808 paddr=0x000b1808 type=SET_64 0x00414300 (ifunc)
vaddr=0x006b1810 paddr=0x000b1810 type=SET_64 0x00479800 (ifunc)
vaddr=0x006b1818 paddr=0x000b1818 type=SET_64 0x004140b0 (ifunc)

10 relocations
EOF
CMDS=<<EOF
ir
EOF
RUN

NAME=is (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Symbols]
Num Paddr      Vaddr      Bind     Type Size Name
001 0x00000200 0x00400200  LOCAL   SECT    0
002 0x0000021c 0x0040021c  LOCAL   SECT    0
003 0x0000023c 0x0040023c  LOCAL   SECT    0
004 0x00000260 0x00400260  LOCAL   SECT    0
005 0x00000280 0x00400280  LOCAL   SECT    0
006 0x000002e0 0x004002e0  LOCAL   SECT    0
007 0x0000031e 0x0040031e  LOCAL   SECT    0
008 0x00000328 0x00400328  LOCAL   SECT    0
009 0x00000348 0x00400348  LOCAL   SECT    0
010 0x00000360 0x00400360  LOCAL   SECT    0
011 0x000003a8 0x004003a8  LOCAL   SECT    0
012 0x000003d0 0x004003d0  LOCAL   SECT    0
013 0x00000410 0x00400410  LOCAL   SECT    0
014 0x000005b4 0x004005b4  LOCAL   SECT    0
015 0x000005c0 0x004005c0  LOCAL   SECT    0
016 0x000005d0 0x004005d0  LOCAL   SECT    0
017 0x00000608 0x00400608  LOCAL   SECT    0
018 0x000006e0 0x006006e0  LOCAL   SECT    0
019 0x000006e8 0x006006e8  LOCAL   SECT    0
020 0x000006f0 0x006006f0  LOCAL   SECT    0
021 0x000006f8 0x006006f8  LOCAL   SECT    0
022 0x000008c8 0x006008c8  LOCAL   SECT    0
023 0x000008d0 0x006008d0  LOCAL   SECT    0
024 0x00000900 0x00600900  LOCAL   SECT    0
025 ---------- 0x00600910  LOCAL   SECT    0
026 ---------- 0x00000000  LOCAL   SECT    0
027 ---------- 0x00000000  LOCAL   FILE    0 init.c
028 ---------- 0x00000000  LOCAL   FILE    0
029 ---------- 0x00000000  LOCAL   FILE    0 crtstuff.c
030 0x000006f0 0x006006f0  LOCAL    OBJ    0 __JCR_LIST__
031 0x00000440 0x00400440  LOCAL   FUNC    0 deregister_tm_clones
032 0x00000470 0x00400470  LOCAL   FUNC    0 register_tm_clones
033 0x000004b0 0x004004b0  LOCAL   FUNC    0 __do_global_dtors_aux
034 ---------- 0x00600910  LOCAL    OBJ    1 completed.6724
035 0x000006e8 0x006006e8  LOCAL    OBJ    0 __do_global_dtors_aux_fini_array_entry
036 0x000004d0 0x004004d0  LOCAL   FUNC    0 frame_dummy
037 0x000006e0 0x006006e0  LOCAL    OBJ    0 __frame_dummy_init_array_entry
038 ---------- 0x00000000  LOCAL   FILE    0 hello.c
039 ---------- 0x00000000  LOCAL   FILE    0 crtstuff.c
040 0x000006d8 0x004006d8  LOCAL    OBJ    0 __FRAME_END__
041 0x000006f0 0x006006f0  LOCAL    OBJ    0 __JCR_END__
042 ---------- 0x00000000  LOCAL   FILE    0
043 0x000006e8 0x006006e8  LOCAL NOTYPE    0 __init_array_end
044 0x000006f8 0x006006f8  LOCAL    OBJ    0 _DYNAMIC
045 0x000006e0 0x006006e0  LOCAL NOTYPE    0 __init_array_start
046 0x000008d0 0x006008d0  LOCAL    OBJ    0 _GLOBAL_OFFSET_TABLE_
047 0x000005b0 0x004005b0 GLOBAL   FUNC    2 __libc_csu_fini
049 0x00000900 0x00600900   WEAK NOTYPE    0 data_start
051 ---------- 0x00600910 GLOBAL NOTYPE    0 _edata
052 0x000005b4 0x004005b4 GLOBAL   FUNC    0 _fini
054 0x00000900 0x00600900 GLOBAL NOTYPE    0 __data_start
056 0x00000908 0x00600908 GLOBAL    OBJ    0 __dso_handle
057 0x000005c0 0x004005c0 GLOBAL    OBJ    4 _IO_stdin_used
058 0x00000520 0x00400520 GLOBAL   FUNC  137 __libc_csu_init
059 ---------- 0x00600918 GLOBAL NOTYPE    0 _end
060 0x00000410 0x00400410 GLOBAL   FUNC    0 _start
061 ---------- 0x00600910 GLOBAL NOTYPE    0 __bss_start
062 0x000004fc 0x004004fc GLOBAL   FUNC   21 main
064 ---------- 0x00600910 GLOBAL    OBJ    0 __TMC_END__
066 0x000003a8 0x004003a8 GLOBAL   FUNC    0 _init
001 0x000003e0 0x004003e0 GLOBAL   FUNC   16 imp.puts
002 0x000003f0 0x004003f0 GLOBAL   FUNC   16 imp.__libc_start_main
003 0x00000400 0x00400400   WEAK NOTYPE   16 imp.__gmon_start__
EOF
CMDS=<<EOF
is
EOF
RUN

NAME=iz (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
[Strings]
Num Paddr      Vaddr      Len Size Section  Type  String
000 0x000005c4 0x004005c4  11  12 (.rodata) ascii Hello World
EOF
CMDS=<<EOF
iz
EOF
RUN

NAME=izq (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
0x4005c4 12 11 Hello World
EOF
CMDS=<<EOF
izq
EOF
RUN

NAME=izqq (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
Hello World
EOF
CMDS=<<EOF
izqq
EOF
RUN

NAME=izzq (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
0x4002fa 5 4 puts
0x15b 18 17 puts@@GLIBC_2.2.5
EOF
CMDS=<<EOF
izzq~puts
EOF
RUN

NAME=izzqq (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
puts
puts@@GLIBC_2.2.5
EOF
CMDS=<<EOF
izzqq~puts
EOF
RUN

NAME=izzqq malloc://512
FILE=malloc://512
EXPECT=<<EOF
Rfh-c
h/sh
h/bin
echo "" > /etc/shadow ; echo "" > /etc/passwd ; rm -Rf /
EOF
CMDS=<<EOF
wx 6a0b58995266682d6389e7682f736800682f62696e89e352e8390000006563686f202222203e202f6574632f736861646f77203b206563686f202222203e202f6574632f706173737764203b20726d202d5266202f00575389e1cd80
izzqq
EOF
RUN

NAME=izzz (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
82
EOF
CMDS=<<EOF
izzz~?
EOF
RUN

NAME=izzzq (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
0x004002fa puts
0x0000015b puts@@GLIBC_2.2.5
EOF
CMDS=<<EOF
izzzq~puts
EOF
RUN

NAME=izzz* (file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
f str.8 10 @ 0x00400034
Cs 10 @ 0x00400034
EOF
CMDS=<<EOF
izzz*~:0
izzz*~:1
EOF
RUN

NAME=izz (no rbin - file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
ARGS=-n
CMDS=izz~puts
EXPECT='004 0x000002fa 0x000002fa   4   5 () ascii puts
065 0x00001953 0x00001953  17  18 () ascii puts@@GLIBC_2.2.5
'
RUN

NAME=izzj (no rbin - file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
ARGS=-n
CMDS='e bin.strpurge=all,!0x2fa,!0x1953
izzj
'
EXPECT='[{"vaddr":762,"paddr":762,"ordinal":4,"size":5,"length":4,"section":"","type":"ascii","string":"cHV0cw=="},{"vaddr":6483,"paddr":6483,"ordinal":65,"size":18,"length":17,"section":"","type":"ascii","string":"cHV0c0BAR0xJQkNfMi4yLjU="}]'
RUN

NAME=izzj 2 (no rbin - file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
ARGS=
CMDS='e bin.strpurge=all,!0x4002fa,!0x15b
izzj
'
EXPECT='[{"vaddr":4195066,"paddr":762,"ordinal":4,"size":5,"length":4,"section":".dynstr","type":"ascii","string":"cHV0cw=="},{"vaddr":347,"paddr":6483,"ordinal":65,"size":18,"length":17,"section":".strtab","type":"ascii","string":"cHV0c0BAR0xJQkNfMi4yLjU="}]'
RUN

NAME=i (no rbin - file x86_64)
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT=<<EOF
blksz    0x0
block    0x100
fd       3
iorw     false
mode     r-x
size     0x1a36
humansz  6.6K
EOF
ARGS=-n
CMDS=<<EOF
i~!file
EOF
RUN

NAME=iM command
FILE=../bins/elf/redpill
EXPECT=<<EOF
[Main]
vaddr=0x0000142e paddr=0x0000142e
EOF
CMDS=<<EOF
iM
EOF
RUN

NAME=iz utf16le
FILE=../bins/elf/strenc
EXPECT=<<EOF
005 0x0000224a 0x0040224a  56 116 (.rodata) utf16le utf16le> \\u00a2\\u20ac\\U00010348 in green:\e[32m ¢€𐍈 \e[0m\n blocks=Basic Latin,Latin-1 Supplement,Currency Symbols,Gothic
007 0x000022c8 0x004022c8  33  68 (.rodata) utf16le is a wall with no embedded zeros\n
EOF
CMDS=<<EOF
e str.escbslash=true
iz~green
iz~wall
EOF
RUN

NAME=iz/izz utf32le
FILE=../bins/elf/strenc
EXPECT=<<EOF
016 0x0000258c 0x0040258c  55 224 (.rodata) utf32le utf32le> \\u00a2\\u20ac\\U00010348 in cyan:\e[36m ¢€𐍈 \e[0m\n blocks=Basic Latin,Latin-1 Supplement,Currency Symbols,Gothic
017 0x0000266c 0x0040266c  48 196 (.rodata) utf32le Mountain range with embedded quad zeros: 𐌀A𐌀A𐌀A\n blocks=Basic Latin,Old Italic
135 0x00002528 0x00402528  24 100 (.rodata) utf32le \tLinux_wide\\esc: \e[0m¡\r\n blocks=Basic Latin,Latin-1 Supplement
EOF
CMDS=<<EOF
e str.escbslash=true
iz~cyan
iz~Mountain
izz~Linux_wide
EOF
RUN

NAME=str.escbslash and iz
FILE=../bins/elf/strenc
EXPECT=<<EOF
015 0x00002528 0x00402528  24 100 (.rodata) utf32le \tLinux_wide\\esc: \e[0m¡\r\n blocks=Basic Latin,Latin-1 Supplement
015 0x00002528 0x00402528  24 100 (.rodata) utf32le \tLinux_wide\esc: \e[0m¡\r\n blocks=Basic Latin,Latin-1 Supplement
EOF
CMDS=<<EOF
e str.escbslash=true
iz~Linux_wide
e str.escbslash=false
iz~Linux_wide
EOF
RUN

NAME=iz utf32le partial
FILE=../bins/elf/strenc-guess-utf32le
EXPECT=<<EOF
001 0x0000060c 0x0040060c   6  28 (.rodata) utf32le ABCDEF
002 0x00000650 0x00400650  10  44 (.rodata) utf32le abcdef𐍈  g blocks=Basic Latin,Gothic
003 0x00000694 0x00400694   6  28 (.rodata) utf32le 123456
EOF
CMDS=<<EOF
iz~ABCDEF
iz~abcdef
iz~123456
EOF
RUN

NAME=ik
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
1
EOF
CMDS=<<EOF
ik~?elf.relro
EOF
RUN

NAME=ibk use after free
FILE=../bins/elf/analysis/x86-helloworld-gcc
EXPECT=<<EOF
1
EOF
CMDS=<<EOF
ibk~?elf.relro
EOF
RUN

NAME=i on freebsd elf
FILE=../bins/elf/analysis/hello-freebsd-x86_64
EXPECT=<<EOF
os       freebsd
EOF
CMDS=<<EOF
i~os
EOF
RUN

NAME=i on openbsd elf
FILE=../bins/elf/analysis/hello-openbsd-x86_64
EXPECT=<<EOF
os       openbsd
EOF
CMDS=<<EOF
i~os
EOF
RUN

NAME=i on netbsd elf
FILE=../bins/elf/analysis/hello-netbsd-x86_64
EXPECT=<<EOF
os       netbsd
EOF
CMDS=<<EOF
i~os
EOF
RUN

NAME=i on hp-ux elf (os)
FILE=../bins/elf/analysis/hello-hpux-ia64
EXPECT=<<EOF
os       hpux
EOF
CMDS=<<EOF
i~os
EOF
RUN

NAME=i on hp-ux elf (arch)
FILE=../bins/elf/analysis/hello-hpux-ia64
EXPECT=<<EOF
arch     ia64
EOF
CMDS=<<EOF
i~arch
EOF
RUN

NAME=izj unicode blocks
FILE=../bins/elf/strenc
EXPECT='[{"vaddr":4202996,"paddr":8692,"ordinal":2,"size":11,"length":10,"section":".rodata","type":"ascii","string":"ZW5fVVMudXRmOA=="},{"vaddr":4203007,"paddr":8703,"ordinal":3,"size":61,"length":54,"section":".rodata","type":"utf8","string":"dXRmOD4gXFx1MDBhMlxcdTIwYWNcXFUwMDAxMDM0OCBpbiB5ZWxsb3c6XGVbMzNtIMKi4oKs8JCNiCBcZVswbVxu","blocks":["Basic Latin","Latin-1 Supplement","Currency Symbols","Gothic"]},{"vaddr":4203208,"paddr":8904,"ordinal":7,"size":68,"length":33,"section":".rodata","type":"utf16le","string":"aXMgYSB3YWxsIHdpdGggbm8gZW1iZWRkZWQgemVyb3Ncbg=="}]'
CMDS=<<EOF
e bin.strpurge=all,!4202996,!4203007,!4203208
izj
EOF
RUN

NAME=izzj unicode blocks
FILE=../bins/elf/strenc-guess-utf32le
EXPECT='[{"vaddr":4195920,"paddr":1616,"ordinal":13,"size":44,"length":10,"section":".rodata","type":"utf32le","string":"YWJjZGVm8JCNiCAgZw==","blocks":["Basic Latin","Gothic"]}]'
CMDS=<<EOF
e bin.strpurge=all,!4195920
izzj
EOF
RUN

NAME=iz/izz bin.strpurge
FILE=../bins/elf/analysis/ls2
EXPECT=<<EOF
--1--
1060 0x00012420 0x00412420   5   6 (.text) ascii AWAVA
--2--
--3--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
002 0x00013233 0x00413233   6   7 (.rodata) ascii posix-
003 0x0001323a 0x0041323a   4   5 (.rodata) ascii main
--4--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
--5--
002 0x00013233 0x00413233   6   7 (.rodata) ascii posix-
--6--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
--7--
003 0x0001323a 0x0041323a   4   5 (.rodata) ascii main
--8--
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
--9--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
--10--
002 0x00013233 0x00413233   6   7 (.rodata) ascii posix-
--11--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
003 0x0001323a 0x0041323a   4   5 (.rodata) ascii main
--12--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
--13--
000 0x000131d8 0x004131d8  11  12 (.rodata) ascii dev_ino_pop
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
--14--
001 0x00013228 0x00413228  10  11 (.rodata) ascii sort_files
002 0x00013233 0x00413233   6   7 (.rodata) ascii posix-
EOF
CMDS=<<EOF
?e --1--
e bin.strpurge=false
izz~0x00412420
?e --2--
e bin.strpurge=true
izz~0x00412420  # Should print nothing
?e --3--
(test_iz,iz~0x004131d8,iz~0x00413228,iz~0x00413233,iz~0x0041323a)
e bin.strpurge=false
.(test_iz)
?e --4--
e bin.strpurge=true
.(test_iz)
?e --5--
e bin.strpurge=0x004131d8,0x00413228,0x0041323a
.(test_iz)
?e --6--
e bin.strpurge=true,0x00413228
.(test_iz)
?e --7--
e bin.strpurge=0x4131d8-0x413233
.(test_iz)
?e --8--
e bin.strpurge=0x413230-0x413240,0x4131d8
.(test_iz)
?e --9--
e bin.strpurge=true,0x413228-0x413228
.(test_iz)
?e --10--
e bin.strpurge=0x413100-0x413300,!0x413233
.(test_iz)
?e --11--
e bin.strpurge=true,!0x41323a
.(test_iz)
?e --12--
e bin.strpurge=true,!0x41323a,0x41323a
.(test_iz)
?e --13--
e bin.strpurge=true,0x4131d8,!0x4131d8
.(test_iz)
?e --14--
e bin.strpurge=all,!0x413220-0x413235
.(test_iz)
EOF
RUN

NAME=iz-
FILE=-
CMDS='iz- @ 0x412420
e bin.strpurge
iz- @ 0x4028a0
e bin.strpurge
iz- 0x414fbf
e bin.strpurge
'
EXPECT='0x412420
0x412420,0x4028a0
0x412420,0x4028a0,0x414fbf
'
RUN

NAME=regression for #9370
FILE=../bins/elf/analysis/hello-arm32
ARGS=-m 0x10000
CMDS='izz~Hello'
EXPECT='006 0x00000200 0x00010200  11  12 (.rodata) ascii Hello World
'
RUN

NAME=iee preinit
FILE=../bins/elf/before-after-main
CMDS=<<EXPECT
iee~type=preinit
e asm.bytes=false
pd 1 @ 0x0804849f
EXPECT=<<RUN
vaddr=0x08048486 paddr=0x00000486 hvaddr=0x08049ed4 hpaddr=0x00000ed4 type=preinit
vaddr=0x0804849f paddr=0x0000049f hvaddr=0x08049ed8 hpaddr=0x00000ed8 type=preinit
            ;-- entry.preinit1:
            ;-- preinit2:
            0x0804849f      push ebp
RUN

NAME=iS entropy and iSS entropy
FILE=../bins/elf/crackme0x05
CMDS=<<EXPECT
iS entropy; iSS entropy
EXPECT=<<RUN
[Sections]
Nm Paddr       Size Vaddr      Memsz Perms Checksum          Name
00 0x00000000     0 0x00000000     0 ---- entropy=0.00000000 
01 0x00000154    19 0x08048154    19 -r-- entropy=3.68188080 .interp
02 0x00000168    32 0x08048168    32 -r-- entropy=1.74868984 .note.ABI_tag
03 0x00000188    56 0x08048188    56 -r-- entropy=1.23442903 .hash
04 0x000001c0    32 0x080481c0    32 -r-- entropy=1.99254169 .gnu.hash
05 0x000001e0   144 0x080481e0   144 -r-- entropy=1.56755604 .dynsym
06 0x00000270    95 0x08048270    95 -r-- entropy=4.38707564 .dynstr
07 0x000002d0    18 0x080482d0    18 -r-- entropy=1.19417373 .gnu.version
08 0x000002e4    32 0x080482e4    32 -r-- entropy=1.66055053 .gnu.version_r
09 0x00000304     8 0x08048304     8 -r-- entropy=2.75000000 .rel.dyn
10 0x0000030c    48 0x0804830c    48 -r-- entropy=2.94082791 .rel.plt
11 0x0000033c    23 0x0804833c    23 -r-x entropy=3.46241535 .init
12 0x00000354   112 0x08048354   112 -r-x entropy=3.51876869 .plt
13 0x000003d0   628 0x080483d0   628 -r-x entropy=5.76534324 .text
14 0x00000644    26 0x08048644    26 -r-x entropy=3.79621760 .fini
15 0x00000660    85 0x08048660    85 -r-- entropy=4.59175306 .rodata
16 0x000006b8     4 0x080486b8     4 -r-- entropy=0.00000000 .eh_frame
17 0x00000f0c     8 0x08049f0c     8 -rw- entropy=1.00000000 .ctors
18 0x00000f14     8 0x08049f14     8 -rw- entropy=1.00000000 .dtors
19 0x00000f1c     4 0x08049f1c     4 -rw- entropy=0.00000000 .jcr
20 0x00000f20   208 0x08049f20   208 -rw- entropy=2.82161069 .dynamic
21 0x00000ff0     4 0x08049ff0     4 -rw- entropy=0.00000000 .got
22 0x00000ff4    36 0x08049ff4    36 -rw- entropy=2.98068211 .got.plt
23 0x00001018    12 0x0804a018    12 -rw- entropy=1.58496250 .data
24 0x00001024     0 0x0804a024     4 -rw- entropy=0.00000000 .bss
25 0x00001024   441 0x00000000   441 ---- entropy=4.50015849 .comment
26 0x000011dd   219 0x00000000   219 ---- entropy=4.21638420 .shstrtab
27 0x00001740  1120 0x00000000  1120 ---- entropy=3.06854806 .symtab
28 0x00001ba0   584 0x00000000   584 ---- entropy=4.85613827 .strtab
[Segments]
Nm Paddr       Size Vaddr      Memsz Perms Checksum          Name
00 0x00000034   288 0x08048034   288 -r-x entropy=2.77947373 PHDR
01 0x00000154    19 0x08048154    19 -r-- entropy=3.68188080 INTERP
02 0x00000000  1724 0x08048000  1724 -r-x entropy=5.13144413 LOAD0
03 0x00000f0c   280 0x08049f0c   284 -rw- entropy=2.96573278 LOAD1
04 0x00000f20   208 0x08049f20   208 -rw- entropy=2.82161069 DYNAMIC
05 0x00000168    32 0x08048168    32 -r-- entropy=1.74868984 NOTE
06 0x00000000     0 0x00000000     0 -rw- entropy=0.00000000 GNU_STACK
07 0x00000f0c   244 0x08049f0c   244 -r-- entropy=2.71815661 GNU_RELRO
08 0x00000000     0 0x00000000     0 ---- entropy=0.00000000 UNKNOWN
09 0x00000000    52 0x08048000    52 -rw- entropy=2.79887339 ehdr
RUN

NAME=is sht null
FILE=../bins/elf/sht_null_symbols
CMDS=<<EOF
is; ir; f
EOF
EXPECT=<<EOF
[Symbols]
Num Paddr      Vaddr      Bind     Type Size Name
008 0x00000590 0x00000590 GLOBAL   FUNC   60 main
009 0x0000064c 0x0000064c GLOBAL    OBJ    4 _IO_stdin_used
001 0x00000000 0x00000000   WEAK NOTYPE   16 imp._ITM_deregisterTMCloneTable
002 0x00000000 0x00000000   WEAK   FUNC   16 imp.__cxa_finalize
003 0x000003f0 0x000003f0 GLOBAL   FUNC   16 imp.puts
004 0x00000000 0x00000000   WEAK NOTYPE   16 imp.__gmon_start__
005 0x00000400 0x00000400 GLOBAL   FUNC   16 imp.__libc_start_main
006 0x00000000 0x00000000   WEAK NOTYPE   16 imp._Jv_RegisterClasses
007 0x00000000 0x00000000   WEAK NOTYPE   16 imp._ITM_registerTMCloneTable
[Relocations]
vaddr=0x00001eec paddr=0x00000eec type=SET_32
vaddr=0x00001ef0 paddr=0x00000ef0 type=SET_32
vaddr=0x00001fe8 paddr=0x00000fe8 type=SET_32 _ITM_deregisterTMCloneTable
vaddr=0x00001fec paddr=0x00000fec type=SET_32 __cxa_finalize
vaddr=0x00001ff0 paddr=0x00000ff0 type=SET_32 __gmon_start__
vaddr=0x00001ff4 paddr=0x00000ff4 type=SET_32
vaddr=0x00001ff8 paddr=0x00000ff8 type=SET_32 _Jv_RegisterClasses
vaddr=0x00001ffc paddr=0x00000ffc type=SET_32 _ITM_registerTMCloneTable
vaddr=0x0000200c paddr=0x0000100c type=SET_32 puts
vaddr=0x00002010 paddr=0x00001010 type=SET_32 __libc_start_main
vaddr=0x00002018 paddr=0x00001018 type=SET_32

11 relocations
0x00000000 1936 segment.LOAD0
0x00000000 0 segment.GNU_STACK
0x00000000 52 segment.ehdr
0x00000000 16 loc.imp._ITM_deregisterTMCloneTable
0x00000000 16 sym.imp.__cxa_finalize
0x00000000 16 loc.imp.__gmon_start
0x00000000 16 loc.imp._Jv_RegisterClasses
0x00000000 16 loc.imp._ITM_registerTMCloneTable
0x00000034 288 segment.PHDR
0x00000154 19 segment.INTERP
0x00000168 68 segment.NOTE
0x00000364 72 section..rel.dyn
0x000003ac 16 section..rela.plt
0x000003f0 16 sym.imp.puts
0x00000400 16 sym.imp.__libc_start_main
0x00000420 1 entry0
0x00000590 256 main
0x00000590 60 sym.main
0x0000064c 4 obj._IO_stdin_used
0x00000658 60 segment.GNU_EH_FRAME
0x00001eec 308 segment.LOAD1
0x00001eec 276 segment.GNU_RELRO
0x00001ef8 240 segment.DYNAMIC
0x00001fe8 4 reloc._ITM_deregisterTMCloneTable
0x00001fec 4 reloc.__cxa_finalize
0x00001ff0 4 reloc.__gmon_start
0x00001ff8 4 reloc._Jv_RegisterClasses
0x00001ffc 4 reloc._ITM_registerTMCloneTable
0x00002000 16 section..got.plt
0x0000200c 4 reloc.puts
0x00002010 4 reloc.__libc_start_main
EOF
RUN

NAME=ieej
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=ieej
EXPECT=<<RUN
[{"vaddr":134513616,"paddr":976,"baddr":134512640,"laddr":0,"hvaddr":134518172,"hpaddr":1436,"type":"init"},{"vaddr":134513584,"paddr":944,"baddr":134512640,"laddr":0,"hvaddr":134518176,"hpaddr":1440,"type":"fini"}]
RUN

NAME=ieeej
FILE=../bins/elf/analysis/x86-helloworld-gcc
CMDS=ieeej~{}
EXPECT=<<RUN
{
  "initfini": [
    {
      "vaddr": 134513616,
      "paddr": 976,
      "baddr": 134512640,
      "laddr": 0,
      "hvaddr": 134518172,
      "hpaddr": 1436,
      "type": "init"
    },
    {
      "vaddr": 134513584,
      "paddr": 944,
      "baddr": 134512640,
      "laddr": 0,
      "hvaddr": 134518176,
      "hpaddr": 1440,
      "type": "fini"
    }
  ],
  "entries": [
    {
      "vaddr": 134513408,
      "paddr": 768,
      "baddr": 134512640,
      "laddr": 0,
      "hvaddr": 134512664,
      "haddr": 24,
      "type": "program"
    }
  ]
}
RUN

NAME=iee elf Cd (32-bit)
FILE=../bins/elf/before-after-main
CMDS=<<EXPECT
pD $SS @ section..preinit_array
?e
pD $SS @ section..init_array
?e
pD $SS @ section..fini_array
EXPECT=<<RUN
            ;-- section..preinit_array:
            ;-- segment.LOAD1:
            ;-- segment.GNU_RELRO:
            ;-- __preinit:
            0x08049ed4      .dword 0x08048486 ; entry.preinit0 ; sym.preinit ; [18] -rw- section size 8 named .preinit_array
            ;-- __preinit2:
            0x08049ed8      .dword 0x0804849f ; entry.preinit1 ; sym.preinit2

            ;-- section..init_array:
            ;-- __frame_dummy_init_array_entry:
            ;-- __init_array_start:
            0x08049edc      .dword 0x08048480 ; entry.init0 ; sym.frame_dummy ; [19] -rw- section size 20 named .init_array
            0x08049ee0      .dword 0x080484b8 ; entry.init1 ; sym.constructor
            ;-- __init:
            0x08049ee4      .dword 0x080484d1 ; entry.init2 ; sym.init
            ;-- __init2:
            0x08049ee8      .dword 0x080484ea ; entry.init3 ; sym.init2
            0x08049eec      .dword 0x08048503 ; entry.init4 ; sym.constructor2

            ;-- section..fini_array:
            ;-- __do_global_dtors_aux_fini_array_entry:
            ;-- __init_array_end:
            0x08049ef0      .dword 0x08048450 ; entry.fini0 ; sym.__do_global_dtors_aux ; [20] -rw- section size 20 named .fini_array
            0x08049ef4      .dword 0x0804859c ; entry.fini1 ; sym.destructor2
            ;-- __fini2:
            0x08049ef8      .dword 0x080485b5 ; entry.fini2 ; sym.fini2
            ;-- __fini:
            0x08049efc      .dword 0x080485ce ; entry.fini3 ; sym.fini
            0x08049f00      .dword 0x080485e7 ; entry.fini4 ; sym.destructor
RUN

NAME=iee elf Cd (64-bit)
FILE=../bins/elf/analysis/ls-linux64
CMDS=<<EXPECT
pD $SS @ section..init_array
?e
pD $SS @ section..fini_array
?e
# Can't be first line for some reason
pD $SS @ section..preinit_array
EXPECT=<<EXPECT_ERR
            ;-- section..init_array:
            ;-- segment.LOAD1:
            ;-- segment.GNU_RELRO:
            0x0021bfa8      .qword 0x0000000000005d20 ; entry.init0    ; RELOC 64  ; [18] -rw- section size 8 named .init_array

            ;-- section..fini_array:
            0x0021bfb0      .qword 0x0000000000005ce0 ; entry.fini0    ; RELOC 64  ; [19] -rw- section size 8 named .fini_array

EXPECT_ERR=<<RUN
Invalid address (section..preinit_array)
|ERROR| Invalid command 'pD $SS @ section..preinit_array' (0x70)
RUN

NAME=iX
FILE=../bins/elf/analysis/dwarf_load
CMDS=iX
EXPECT=<<RUN
[Source file]
/home/landley/work/ab7/build/temp-armv6l/gcc-core/gcc/config/arm/ieee754-df.S
/home/landley/work/ab7/build/temp-armv6l/gcc-core/gcc/config/arm/lib1funcs.asm
RUN

NAME=iM main sym
FILE=../bins/elf/before-after-main
CMDS=iM
EXPECT=<<RUN
[Main]
vaddr=0x0804854e paddr=0x0000054e
RUN

NAME=iSj
FILE=../bins/pe/hello-mingw32
EXPECT='[
  {
    "name": ".text",
    "size": 2560,
    "vsize": 4096,
    "perm": "-r-x",
    "paddr": 1024,
    "vaddr": 4198400
  },
  {
    "name": ".data",
    "size": 512,
    "vsize": 4096,
    "perm": "-rw-",
    "paddr": 3584,
    "vaddr": 4202496
  },
  {
    "name": ".rdata",
    "size": 512,
    "vsize": 4096,
    "perm": "-r--",
    "paddr": 4096,
    "vaddr": 4206592
  },
  {
    "name": ".bss",
    "size": 0,
    "vsize": 4096,
    "perm": "-rw-",
    "paddr": 0,
    "vaddr": 4210688
  },
  {
    "name": ".idata",
    "size": 1024,
    "vsize": 4096,
    "perm": "-rw-",
    "paddr": 4608,
    "vaddr": 4214784
  }
]
'
CMDS=<<EOF
iSj~{}
EOF
RUN

NAME=ii dupped imports
FILE=../bins/elf/varsub
BROKEN=1
CMDS=ii
EXPECT=<<RUN
[Imports]
Num  Vaddr       Bind      Type Name
   1 0x00000000  GLOBAL    FUNC __libc_start_main
   2 0x00000000    WEAK  NOTYPE __gmon_start__
RUN

NAME=iI~laddr
FILE=../bins/mach0/fatmach0-3true
ARGS=-m 0x5000
CMDS=iI~laddr
EXPECT=<<RUN
laddr    0x5000
RUN

# Should not be run on Windows
NAME=utf8 (possibly malformed) filenames with non-printable chars
FILE=-
CMDS=<<EXPECT
e io.cache=true
"(show_fname fname, wz $0, wtf `prz`, o `prz`, i~file, ij, rm `prz`)"
.(show_fname A\x1b¢\302\200€𝄞\363\240\201\201\\.bin)
.(show_fname B\x1b¢\302\200\200€𝄞\363\240\201\201\\.bin)
  # TODO: fix i~file output
EXPECT=<<RUN
file     A�€𝄞󠁁\.bin
{"core":{"type":"","file":"A\u001b¢\u0080€𝄞\udb40\udc41\\.bin","fd":4,"size":256,"humansz":"256","iorw":true,"mode":"r-x","obsz":0,"block":256,"format":"any"}}
file     B��€𝄞󠁁\.bin
{"core":{"type":"","file":"B\u001b¢\u0080\x80€𝄞\udb40\udc41\\.bin","fd":5,"size":256,"humansz":"256","iorw":true,"mode":"r-x","obsz":0,"block":256,"format":"any"}}
RUN

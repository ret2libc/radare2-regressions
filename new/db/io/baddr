NAME=1: io.baddr
FILE=../bins/elf/analysis/pie
ARGS=
EXPECT64=MHg0NTAKCg==
CMDS64=Cj92IGVudHJ5MAoK
RUN
NAME=2: io.baddr
FILE=../bins/elf/analysis/pie
ARGS=-B 0xf00000
EXPECT64=MHhmMDA0NTAKCg==
CMDS64=Cj92IGVudHJ5MAoK
RUN
NAME=3: io.baddr
FILE=../bins/elf/analysis/pie
EXPECT64=ZiBlbnRyeTAgMSBAIDB4MDBmMDA0NTAKZiBlbnRyeTBfaGFkZHIgMSBAIDB4MDAwMDAwMTgK
CMDS64=IXJhYmluMiAtQiAweGYwMDAwMCAtcmUgJHtSMl9GSUxFfSB8IGdyZXAgMHgK
RUN
NAME=io.baddr entry0 data
FILE=../bins/elf/analysis/pie
EXPECT64=MHgwMDAwMDQ1MAoweDAwMDAwNDUwCjMxZWQ1ZTg5ZTE4M2U0ZjA1MDU0Cgo=
CMDS64=CmllfnBhZGRyWzNdCmllfnZhZGRyWzFdCnA4IDEwIEAgMHgwMDAwMDQ1MAoK
RUN
NAME=io.baddr -B entry0 data
FILE=../bins/elf/analysis/pie
ARGS=-B 0x100000
EXPECT64=MzFlZDVlODllMTgzZTRmMDUwNTQKCg==
CMDS64=cDggMTAgQCAweDAwMTAwNDUwCgo=
RUN
NAME=io.baddr -x86_32 entry0 data
FILE=../bins/mach0/fatmach0-3true
ARGS=-a x86 -b 32
EXPECT64=MHgwMDAwNWY0NAoweDAwMDAxZjQ0CjZhMDA4OWU1ODNlNGYwODNlYzEwCjZhMDA4OWU1ODNlNGYwODNlYzEwCgo=
CMDS64=CmllfnBhZGRyWzNdCmllfnZhZGRyWzFdCnA4IDEwIEAgMHgwMDAwMWY0NApwOCAxMCBAIDB4MDAwMDVmNDQKCg==
RUN
NAME=4: io.baddr
FILE=../bins/elf/analysis/pie
ARGS=-B 0xf00000
EXPECT64=ZiBlbnRyeTAgMSBAIDB4MDBmMDA0NTAKZiBlbnRyeTBfaGFkZHIgMSBAIDB4MDAwMDAwMTgKMzFlZDVlODllMTgzZTRmMDUwNTQK
CMDS64=IXJhYmluMiAtQiAweGYwMDAwMCAtcmUgJHtSMl9GSUxFfSB8IGdyZXAgMHgKcDggMTAgQCAweDAwZjAwNDUwCg==
RUN
NAME=e bin.baddr
FILE=../bins/elf/analysis/hello-linux-x86_64
EXPECT64=MHg0MDAwMDAKCg==
CMDS64=P3YgYGUgYmluLmJhZGRyYAoK
RUN
NAME=e bin.baddr changed
FILE=../bins/elf/analysis/hello-linux-x86_64
ARGS=-B 0xf00000
EXPECT64=MHhmMDAwMDAKCg==
CMDS64=P3YgYGUgYmluLmJhZGRyYAoK
RUN
NAME=bin.baddr and anal
FILE=../bins/elf/analysis/pie
ARGS=-B 0xf00000
EXPECT64=MHgwMGYwMDNlYyAgICAzIDM1ICAgICAgICAgICBzeW0uX2luaXQKMHgwMGYwMDQyMCAgICAxIDYgICAgICAgICAgICBzeW0uaW1wLl9fY3hhX2ZpbmFsaXplCjB4MDBmMDA0MzAgICAgMSA2ICAgICAgICAgICAgbG9jLmltcC5fX2dtb25fc3RhcnQKMHgwMGYwMDQ0MCAgICAxIDYgICAgICAgICAgICBzeW0uaW1wLl9fbGliY19zdGFydF9tYWluCjB4MDBmMDA0NTAgICAgMSA1MCAgICAgICAgICAgZW50cnkwCjB4MDBmMDA0ODIgICAgMSA0ICAgICAgICAgICAgZmNuLjAwZjAwNDgyCjB4MDBmMDA0OTAgICAgMSA0ICAgICAgICAgICAgc3ltLl9feDg2LmdldF9wY190aHVuay5ieAoweDAwZjAwNGEwICAgIDQgNjEgICAgICAgICAgIHN5bS5kZXJlZ2lzdGVyX3RtX2Nsb25lcwoweDAwZjAwNGUwICAgIDQgNzEgICAgICAgICAgIHN5bS5yZWdpc3Rlcl90bV9jbG9uZXMKMHgwMGYwMDUzMCAgICA1IDcxICAgICAgICAgICBzeW0uX19kb19nbG9iYWxfZHRvcnNfYXV4CjB4MDBmMDA1ODAgICAgNCA2OSAgIC0+IDYwICAgZW50cnkxLmluaXQKMHgwMGYwMDVjNSAgICAxIDQgICAgICAgICAgICBzeW0ubWFpbgoweDAwZjAwNWQwICAgIDQgOTcgICAgICAgICAgIHN5bS5fX2xpYmNfY3N1X2luaXQKMHgwMGYwMDY0MCAgICAxIDIgICAgICAgICAgICBzeW0uX19saWJjX2NzdV9maW5pCjB4MDBmMDA2NDQgICAgMSAyMCAgICAgICAgICAgc3ltLl9maW5pCg==
CMDS64=YWFhCmFmbAoK
RUN
